<!DOCTYPE html>
<html>
<head>
    <title>Profil - MyCargonaut</title>
    <link rel="stylesheet" type="text/css" href="css/dashboard.css">
</head>
<body class="dashboard">
    <header>
        <nav>
            <ul>
                <li><a href="dashboard.html">Startseite</a></li>
                <li><a href="profile.html">Profil</a></li>
                <li><a href="vehicles.html">Fahrzeugverwaltung</a></li>
                <li><a href="offers.html">Angebote</a></li>
                <li><a href="search.html">Suchanfragen</a></li>
                <li><a href="myrides.html">Meine Fahrten</a></li>
                <li><a href="support.html">Support</a></li>
                <li><a href="logout.html">Abmelden</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="profile-container">
            <h2>Benutzerprofil</h2>
            <div class="profile-info">
                <!-- Benutzerinformationen werden hier angezeigt -->
            </div>

            <h2>Geld hinzufügen</h2>
            <form id="addMoneyForm">
                <label for="paymentMethod">Zahlungsmethode:</label>
                <select id="paymentMethod" name="paymentMethod">
                    <option value="paypal">PayPal</option>
                    <option value="creditcard">Kreditkarte</option>
                    <option value="banktransfer">Banküberweisung</option>
                </select>

                <label for="amount">Betrag:</label>
                <input type="number" id="amount" name="amount" step="0.01" placeholder="Betrag in Euro" required>

                <button type="submit">Geld hinzufügen</button>
            </form>
        </section>
    </main>

    <footer>
        <p>© 2023 MyCargonaut</p>
    </footer>

    <script>
        window.onload = async () => {
            try {
                const response = await fetch('/getUserData');
                if (!response.ok) throw new Error('Fehler beim Laden der Benutzerdaten');

                const userData = await response.json();
                document.querySelector('.profile-info').innerHTML = `
                        <p><strong>Benutzername:</strong> ${userData.benutzername}</p>
                        <p><strong>E-Mail:</strong> ${userData.email}</p>
                        <p><strong>Handynummer:</strong> ${userData.handynummer}</p>
                        <p><strong>Geburtsdatum:</strong> ${userData.tag}.${userData.monat}.${userData.jahr}</p>
                        <p><strong>Bewertung:</strong> ${userData.bewertung}</p>
                        <p><strong>goldene Küchlers:</strong> ${userData.geld}</p>
                    `;
            } catch (err) {
                console.error('Fehler:', err);
            }
        };
        document.getElementById('addMoneyForm').addEventListener('submit', async (event) => {
            event.preventDefault();
            const amount = document.getElementById('amount').value;
            const response = await fetch('/addMoney', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: new URLSearchParams({ amount: amount })
            });

            if (response.ok) {
                alert('Geld erfolgreich hinzugefügt');
                window.location.reload(); // Seite neu laden, um das aktualisierte Guthaben anzuzeigen
            } else {
                const errorText = await response.text();
                alert('Fehler: ' + errorText);
            }
        });
    </script>
</body>
</html>
